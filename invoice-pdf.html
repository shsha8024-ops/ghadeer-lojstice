<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© | Ø´Ø±ÙƒØ© Ø§Ù„ØºØ¯ÙŠØ± Ù„Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„ØªØ®Ù„ÙŠØµ Ø§Ù„ÙƒÙ…Ø±ÙƒÙŠ</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
<style>
body {
  font-family: "Cairo", sans-serif;
  background: #fff;
  margin: 0;
  color: #000;
  padding: 2rem;
  direction: rtl;
  position: relative;
}

/* ===== Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© ===== */
body::before {
  content: "";
  position: fixed;
  top: 30%;
  left: 50%;
  transform: translate(-50%, -30%);
  width: 400px;
  height: 400px;
  background: url('ghadeer-logo.png') no-repeat center center;
  background-size: contain;
  opacity: 0.08;
  z-index: -1;
}

.print-area {
  max-width: 800px;
  margin: auto;
  background: #fff;
  padding: 2rem;
  border: 1px solid #ccc;
  border-radius: 10px;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
}
header {
  text-align: center;
  border-bottom: 2px solid #c2a356;
  padding-bottom: 1rem;
}
header img {
  width: 90px;
  height: 90px;
}
header h1 {
  margin: 0;
  color: #000;
}
header p {
  margin: 0;
  color: #444;
  font-weight: 600;
}
.info {
  margin-top: 1.5rem;
  font-size: 1rem;
  color: #000;
}
.info p { margin: 5px 0; }

/* ===== Ø§Ù„Ø¬Ø¯ÙˆÙ„ ===== */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1.5rem;
  border: 1px solid #ccc;
}
th {
  background: #f9f9f9;
  color: #004b95; /* Ø£Ø²Ø±Ù‚ Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† */
  font-weight: bold;
}
td {
  border: 1px solid #bbb;
  padding: 8px;
  text-align: center;
  color: #000; /* âœ… Ù†ØµÙˆØµ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„Ø£Ø³ÙˆØ¯ */
}
tfoot td {
  background: #fef7d3;
  font-weight: bold;
  color: #000; /* Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø§Ù„Ø£Ø³ÙˆØ¯ */
}

/* ===== Ø§Ù„ØªØ°ÙŠÙŠÙ„ ===== */
.footer-note {
  margin-top: 2rem;
  font-size: 0.9rem;
  color: #000;
  text-align: center;
  border-top: 2px solid #ccc;
  padding-top: 1rem;
}

/* ===== Ø§Ù„Ø£Ø²Ø±Ø§Ø± ===== */
.actions {
  text-align: center;
  margin-top: 2rem;
}
button {
  background: linear-gradient(90deg,#004b95,#008d5f);
  color: #fff;
  border: none;
  padding: 12px 25px;
  margin: 5px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  position: relative;
  overflow: hidden;
}
button::after {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: rgba(255,215,0,0.3);
  transition: 0.4s;
}
button:active::after { left: 0; transition: 0s; }
button:hover { background: #008d5f; transform: translateY(-2px); }

@media print {
  .actions { display: none; }
  body { background: #fff; color: #000; }
  .print-area { box-shadow: none; border: none; margin: 0; }
  body::before { opacity: 0.06; }
}
</style>
</head>
<body>

<div class="print-area" id="printArea">
  <header>
    <img src="ghadeer-logo.png" alt="ghadeer logo">
    <h1>Ø´Ø±ÙƒØ© Ø§Ù„ØºØ¯ÙŠØ± Ù„Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„ØªØ®Ù„ÙŠØµ Ø§Ù„ÙƒÙ…Ø±ÙƒÙŠ</h1>
    <p>Ghadeer Transport & Customs Clearance</p>
  </header>

  <section class="info">
    <p><strong>ğŸ“„ Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</strong> <span id="invId"></span></p>
    <p><strong>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> <span id="invDate"></span></p>
    <p><strong>ğŸ•’ Ø§Ù„Ø³Ø§Ø¹Ø©:</strong> <span id="invTime"></span></p>
  </section>

  <table>
    <thead>
      <tr>
        <th>Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„</th>
        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
        <th>Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚</th>
        <th>Ø±Ù‚Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø©</th>
        <th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th>
        <th>Ù…Ù„Ø§Ø­Ø¸Ø©</th>
        <th>Ø§Ù„Ù…Ø¨Ù„Øº ($)</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
    <tfoot>
      <tr>
        <td colspan="6">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº</td>
        <td id="total">$0.00</td>
      </tr>
    </tfoot>
  </table>

  <div class="footer-note">
    Zakho - Ibrahim Khalil | ğŸ“² 0750 408 4359 | ğŸ“§ starzeki001@gmail.com
  </div>
</div>

<div class="actions">
  <button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
  <button onclick="downloadPDF()">ğŸ’¾ ØªÙ†Ø²ÙŠÙ„ PDF</button>
  <button onclick="goBack()">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
const invoice = JSON.parse(localStorage.getItem('selectedInvoice') || '{}');
if (!invoice.id) {
  document.getElementById('printArea').innerHTML = '<h3 style="text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙØ§ØªÙˆØ±Ø©</h3>';
} else {
  document.getElementById('invId').textContent = invoice.id;
  const now = new Date();
  document.getElementById('invDate').textContent = now.toLocaleDateString('ar-IQ');
  document.getElementById('invTime').textContent = now.toLocaleTimeString('ar-IQ');
  let total = 0;
  const tbody = document.getElementById('tbody');
  invoice.receipts.forEach(r => {
    total += r.amount;
    tbody.innerHTML += `
      <tr>
        <td>${r.id}</td>
        <td>${r.date}</td>
        <td>${r.driver}</td>
        <td>${r.car}</td>
        <td>${r.city}</td>
        <td>${r.note}</td>''
        <td>${r.amount.toFixed(2)}$</td>
      </tr>`;
  });
  document.getElementById('total').textContent = total.toFixed(2) + '$';
}

function downloadPDF() {
  const element = document.getElementById('printArea');
  const opt = {
    margin: 0.5,
    filename: `${invoice.id || 'ÙØ§ØªÙˆØ±Ø©'}.pdf`,
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
  };
  html2pdf().set(opt).from(element).save();
}

function goBack() {
  // ÙŠØ±Ø¬Ø¹ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±
  window.location.href = "invoice-details.html";

}
</script>
</body>
</html>